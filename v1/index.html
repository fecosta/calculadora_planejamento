<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calculadora de Planejamento de Aulas</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Archivo:100..900&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <style>
    body { background:#fff; max-width:600px; margin:0 auto; padding:2em; }
    h1 { font-family:Archivo, sans-serif; text-align:center; color:#333; font-weight:900 }
    label { display:block; margin-top:1em; font-weight:700; font-family:Archivo, sans-serif; }
    input { width:100%; padding:0.5em; margin-top:0.25em; box-sizing:border-box; font-family: sans-serif; }
    button { margin-top:2em; padding:1em; width:100%; font-size:16px; border:none; cursor:pointer; font-family:Archivo, sans-serif;}
    button:hover{ opacity:.8; }
    .calculate-button{ background:#4C61FF; color:#FFF; }
    .print-button{ background:#2196F3; color:#fff; margin-top:1em; display:none; }
    .results{ margin-top:2em; padding:1em; background:#eef; border-left:5px solid #4CAF50; display:none; font-family:Archivo, sans-serif; }
    .modal{ display:none; position:fixed; inset:0; background:rgba(0,0,0,.6); justify-content:center; align-items:center; z-index:9999; font-family:Archivo, sans-serif; }
    .modal-content{ background:#fff; padding:2em; border-radius:8px; max-width:450px; width:90%; }
    ._submit{background-color:#FF4C61; font-family:sans-serif; }
  </style>
</head>
<body>
  <h1>üìò Planejamento de Aulas</h1>

  <label>‚è±Ô∏è Tempo para planejar uma aula (h):
    <input type="number" id="tempo" value="1" step="0.5">
  </label>
  <label>üìÖ Aulas por semana:
    <input type="number" id="aulas" value="10">
  </label>
  <label>üí∞ Pre√ßo por hora/aula (R$):
    <input type="number" id="preco" value="100">
  </label>

  <button class="calculate-button" onclick="calcular()">Calcular</button>

  <div class="results" id="resultados"></div>
  <button class="print-button" id="print-btn" onclick="window.print()">üñ®Ô∏è Imprimir Resultados</button>

  <!-- Modal com formul√°rio -->
  <div class="modal" id="modal">
    <div class="modal-content">
      <h3>üîí Informe seus dados para visualizar o resultado</h3>

      <form method="POST" action="https://arnese.activehosted.com/proc.php" id="_form_120_" class="_form _form_120 _inline-form _dark" novalidate data-styles-version="5">
        <input type="hidden" name="u" value="120" />
        <input type="hidden" name="f" value="120" />
        <input type="hidden" name="s" />
        <input type="hidden" name="c" value="0" />
        <input type="hidden" name="m" value="0" />
        <input type="hidden" name="act" value="sub" />
        <input type="hidden" name="v" value="2" />
        <input type="hidden" name="or" value="c7718130acc52be2e48c206c02dc0a90" />

        <div class="_form-content">
          <div class="_form_element _x88496739 _full_width">
            <label for="fullname" class="_form-label">Nome<span class="field-required">*</span></label>
            <div class="_field-wrapper">
              <input type="text" id="fullname" name="fullname" placeholder="Digite seu nome" required/>
            </div>
          </div>

          <div class="_form_element _x57568190 _full_width">
            <label for="email" class="_form-label">Email<span class="field-required">*</span></label>
            <div class="_field-wrapper">
              <input type="text" id="email" name="email" placeholder="Digite seu email" required/>
            </div>
          </div>

          <!-- Campos adicionais ocultos -->
          <input type="hidden" id="field[40]" name="field[40]" value="" /> <!-- Horas semana -->
          <input type="hidden" id="field[41]" name="field[41]" value="" /> <!-- Horas m√™s -->
          <input type="hidden" id="field[42]" name="field[42]" value="" /> <!-- Custo/hora -->
          <input type="hidden" id="field[43]" name="field[43]" value="" /> <!-- Custo/m√™s -->
          <input type="hidden" id="field[44]" name="field[44]" value="" /> <!-- Pre√ßo hora/aula -->

          <div class="_button-wrapper _full_width">
            <button id="_form_120_submit" class="_submit" type="submit">Enviar</button>
          </div>
        </div>
        <div class="_form-thank-you" style="display:none;"></div>
      </form>

      <script>
        let dadosCalculados = "";
        let formularioEnviado = false;

        function formatarMoeda(valor) {
          return valor.toLocaleString('pt-BR', { style:'currency', currency:'BRL' });
        }

        function mostrarResultadosNaPagina(){
          const resultados = document.getElementById('resultados');
          resultados.innerHTML = dadosCalculados;
          resultados.style.display = 'block';
          document.getElementById('print-btn').style.display = 'inline-block';
        }

        function getACField(id) {
          return document.getElementById(id) || document.querySelector(`[name="${id}"]`);
        }

        function preencherCamposACComCalculo(){
          const tempo = parseFloat(document.getElementById('tempo').value);
          const aulas = parseFloat(document.getElementById('aulas').value);
          const preco = parseFloat(document.getElementById('preco').value);
          if ([tempo,aulas,preco].some(v => isNaN(v))) return;

          const semanal = tempo * aulas;
          const mensal  = semanal * 4;
          const custoHora   = preco / 2;
          const custoMensal = custoHora * mensal;

          const f40 = getACField('field[40]');
          const f41 = getACField('field[41]');
          const f42 = getACField('field[42]');
          const f43 = getACField('field[43]');
          const f44 = getACField('field[44]'); // pre√ßo/hora aula

          if (f40) f40.value = String(semanal);
          if (f41) f41.value = String(mensal);
          if (f42) f42.value = (custoHora).toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
          if (f43) f43.value = (custoMensal).toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
          if (f44) f44.value = (preco).toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
        }

        window._form_callback = function(id){
          formularioEnviado = true;
          document.getElementById('modal').style.display = 'none';
          mostrarResultadosNaPagina();
        };

        window._show_thank_you = function(id){ if (typeof window._form_callback === 'function') window._form_callback(id); };
        window._show_error = function(id, message){ alert(message || 'Falha ao enviar.'); };

        (function(){
          const form = document.getElementById('_form_120_');
          if (!form) return;
          const formSupportsPost = true;

          function _form_serialize(form){
            var i,j,q=[]; for(i=0;i<form.elements.length;i++){
              if(form.elements[i].name==="") continue;
              q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));
            } return q.join("&");
          }

          form.addEventListener('submit', function(e){
            e.preventDefault();
            try { preencherCamposACComCalculo(); } catch(_) {}

            const btn = form.querySelector('#_form_120_submit');
            if (btn){ btn.disabled = true; btn.classList.add('processing'); }

            const serialized = _form_serialize(form).replace(/%0A/g, '\\n');
            async function submitForm(){
              const formData = new FormData();
              const params = new URLSearchParams(serialized);
              params.forEach((value,key)=>{ formData.append(key,value); });
              const resp = await fetch('https://arnese.activehosted.com/proc.php?jsonp=true', { method:'POST', body:formData, headers:{ "Accept":"application/json" }});
              return resp.json();
            }

            submitForm()
              .then((data)=>{ try { eval(data.js); } catch(e){ alert('Erro ao processar resposta.'); } })
              .catch(()=>{ alert('Falha no envio.'); })
              .finally(()=>{ if (btn){ btn.disabled=false; btn.classList.remove('processing'); }});
          });
          window.__preencherCamposACComCalculo = preencherCamposACComCalculo;
        })();
      </script>
    </div>
  </div>

  <script>
    function calcular() {
      const tempo = parseFloat(document.getElementById('tempo').value);
      const aulas = parseFloat(document.getElementById('aulas').value);
      const preco = parseFloat(document.getElementById('preco').value);

      const semanal = tempo * aulas;
      const mensal = semanal * 4;
      const dias = Math.floor(mensal / 24);
      const horasRestantes = mensal % 24;
      const diasTexto = dias > 0 ? `${dias} dia${dias > 1 ? 's' : ''}` : "";
      const horasTexto = horasRestantes > 0 ? `${horasRestantes} hora${horasRestantes > 1 ? 's' : ''}` : "";
      const complemento = diasTexto && horasTexto ? `${diasTexto} e ${horasTexto}` : diasTexto || horasTexto;
      const mostraComplemento = mensal >= 24 ? ` / <strong>${complemento}</strong>` : "";

      const custoHora = preco / 2;
      const custoMensal = custoHora * mensal;

      dadosCalculados = `
        <h2>üìä Resultados</h2>
        <p>üóìÔ∏è Horas de planejamento por semana: <strong>${semanal}h</strong></p>
        <p>üìÜ Horas de planejamento por m√™s: <strong>${mensal}h</strong>${mostraComplemento}</p>
        <p>üí∏ Custo do planejamento por hora: <strong>${formatarMoeda(custoHora)}</strong></p>
        <p>üíº Custo total do planejamento mensal: <strong>${formatarMoeda(custoMensal)}</strong></p>
      `;

      if (typeof window.__preencherCamposACComCalculo === 'function') {
        try { window.__preencherCamposACComCalculo(); } catch(e){}
      }

      if (!formularioEnviado) {
        document.getElementById('modal').style.display = 'flex';
      } else {
        mostrarResultadosNaPagina();
      }
    }
  </script>
</body>
</html>