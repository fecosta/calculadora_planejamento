<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calculadora de Planejamento de Aulas</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Archivo:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&amp;display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <style>
    body {
      background-color: #fff;
      max-width: 600px;
      margin: 0 auto;
      padding: 2em;
    }
    h1 {
      font-family: Archivo, sans-serif;
      text-align: center;
      color: #333;
    }
    label {
      display: block;
      margin-top: 1em;
      font-weight: bold;
      font-family: Archivo, sans-serif;
    }
    input {
      width: 100%;
      padding: 0.5em;
      margin-top: 0.25em;
      box-sizing: border-box;
      font-family: Archivo, sans-serif;
    }
    button {
      margin-top: 2em;
      padding: 1em;
      width: 100%;
      font-size: 16px;
      border: none;
      cursor: pointer;
      font-family: Archivo, sans-serif;
    }
    button:hover {
      opacity: 0.9;
    }
    .calculate-button {
      background-color: #4CAF50;
      color: white;
      font-family: Archivo, sans-serif;
    }
    .print-button {
      background-color: #2196F3;
      color: white;
      margin-top: 1em;
      font-family: Archivo, sans-serif;
    }
    .results {
      margin-top: 2em;
      padding: 1em;
      background: #eef;
      border-left: 5px solid #4CAF50;
      display: none;
      font-family: Archivo, sans-serif;
    }
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.6);
      justify-content: center;
      align-items: center;
      z-index: 9999;
      font-family: Archivo, sans-serif;
    }
    .modal-content {
      background: white;
      padding: 2em;
      border-radius: 8px;
      max-width: 450px;
      width: 90%;
      font-family: Archivo, sans-serif;
    }
  </style>
</head>
<body>
  <h1>üìò Planejamento de Aulas</h1>

  <label>‚è±Ô∏è Tempo para planejar uma aula (h):
    <input type="number" id="tempo" value="1" step="0.5">
  </label>
  <label>üìÖ Aulas por semana:
    <input type="number" id="aulas" value="10">
  </label>
  <label>üí∞ Pre√ßo por hora/aula (R$):
    <input type="number" id="preco" value="100">
  </label>

  <button class="calculate-button" onclick="calcular()">Calcular</button>

  <div class="results" id="resultados"></div>

  <button class="print-button" onclick="window.print()">üñ®Ô∏è Imprimir Resultados</button>

  <!-- Modal com formul√°rio -->
  <div class="modal" id="modal">
    <div class="modal-content">
      <h3>üîí Informe seus dados para visualizar o resultado</h3>

      <!-- ===== Formul√°rio ActiveCampaign ===== -->
      <style>@import url(https://fonts.bunny.net/css?family=inter-tight:400,700);</style>
      <style>
      #_form_120_{font-size:14px;line-height:1.6;font-family:arial, helvetica, sans-serif;margin:0}#_form_120_ *{outline:0}._form_hide{display:none;visibility:hidden}._form_show{display:block;visibility:visible}#_form_120_._form-top{top:0}#_form_120_._form-bottom{bottom:0}#_form_120_._form-left{left:0}#_form_120_._form-right{right:0}#_form_120_ input[type="text"],#_form_120_ input[type="tel"],#_form_120_ input[type="date"],#_form_120_ textarea{padding:6px;height:auto;border:#979797 1px solid;border-radius:4px;color:#000 !important;font-size:14px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}#_form_120_ textarea{resize:none}#_form_120_ ._submit{-webkit-appearance:none;cursor:pointer;font-family:arial, sans-serif;font-size:14px;text-align:center;background:#1F1F1F !important;border:0 !important;-moz-border-radius:0px !important;-webkit-border-radius:0px !important;border-radius:0px !important;color:#FFFFFF !important;padding:10px !important}#_form_120_ ._submit:disabled{cursor:not-allowed;opacity:0.4}#_form_120_ ._submit.processing{position:relative}#_form_120_ ._submit.processing::before{content:"";width:1em;height:1em;position:absolute;z-index:1;top:50%;left:50%;border:double 3px transparent;border-radius:50%;background-image:linear-gradient(#1F1F1F, #1F1F1F), conic-gradient(#1F1F1F, #FFFFFF);background-origin:border-box;background-clip:content-box, border-box;animation:1200ms ease 0s infinite}#_form_120_ ._submit.processing::after{content:"";position:absolute;top:0;bottom:0;left:0;right:0}@keyframes _spin{0%{transform:translate(-50%, -50%) rotate(90deg)}100%{transform:translate(-50%, -50%) rotate(450deg)}}#_form_120_ ._form-element *{font-size:14px}#_form_120_{position:relative;text-align:left;margin:10px 0 0;max-width:400px}
      </style>

      <form method="POST" action="https://arnese.activehosted.com/proc.php" id="_form_120_" class="_form _form_120 _inline-form  _dark" novalidate data-styles-version="5">
        <input type="hidden" name="u" value="120" />
        <input type="hidden" name="f" value="120" />
        <input type="hidden" name="s" />
        <input type="hidden" name="c" value="0" />
        <input type="hidden" name="m" value="0" />
        <input type="hidden" name="act" value="sub" />
        <input type="hidden" name="v" value="2" />
        <input type="hidden" name="or" value="c7718130acc52be2e48c206c02dc0a90" />

        <div class="_form-content">
          <div class="_form_element _x88496739 _full_width">
            <label for="fullname" class="_form-label">nome<span class="field-required">*</span></label>
            <div class="_field-wrapper">
              <input type="text" id="fullname" name="fullname" placeholder="Digite seu nome" required/>
            </div>
          </div>

          <div class="_form_element _x57568190 _full_width">
            <label for="email" class="_form-label">email<span class="field-required">*</span></label>
            <div class="_field-wrapper">
              <input type="text" id="email" name="email" placeholder="Digite seu email" required/>
            </div>
          </div>

          <!-- ===== Campos ocultos que receber√£o os resultados do c√°lculo ===== -->
          <!-- field[40]: Horas de planejamento por semana -->
          <input type="hidden" id="field40" name="field[40]" value="" />
          <!-- field[41]: Horas de planejamento por m√™s -->
          <input type="hidden" id="field41" name="field[41]" value="" />
          <!-- field[42]: Custo do planejamento por hora -->
          <input type="hidden" id="field42" name="field[42]" value="" />
          <!-- field[43]: Custo total do planejamento mensal -->
          <input type="hidden" id="field43" name="field[43]" value="" />
          <!-- ================================================================ -->

          <div class="_button-wrapper _full_width">
            <button id="_form_120_submit" class="_submit" type="submit">Enviar</button>
          </div>
          <div class="_clear-element"></div>
        </div>
        <div class="_form-thank-you" style="display:none;"></div>
      </form>

      <script>
      window.cfields = []; // mant√©m padr√£o do embed
      window._show_thank_you = function(id, message, trackcmp_url, email) {
          var form = document.getElementById('_form_' + id + '_'), thank_you = form.querySelector('._form-thank-you');
          form.querySelector('._form-content').style.display = 'none';
          thank_you.innerHTML = message;
          thank_you.style.display = 'block';
          const vgoAlias = typeof visitorGlobalObjectAlias === 'undefined' ? 'vgo' : visitorGlobalObjectAlias;
          var visitorObject = window[vgoAlias];
          if (email && typeof visitorObject !== 'undefined') {
              visitorObject('setEmail', email);
              visitorObject('update');
          } else if (typeof(trackcmp_url) != 'undefined' && trackcmp_url) {
              _load_script(trackcmp_url);
          }
          if (typeof window._form_callback !== 'undefined') window._form_callback(id);
      };
      window._show_unsubscribe = function(id, message, trackcmp_url, email) {
          var form = document.getElementById('_form_' + id + '_'), unsub = form.querySelector('._form-thank-you');
          var branding = form.querySelector('._form-branding');
          if (branding) { branding.style.display = 'none'; }
          form.querySelector('._form-content').style.display = 'none';
          unsub.style.display = 'block';
          form.insertAdjacentHTML('afterend', message)
          const vgoAlias = typeof visitorGlobalObjectAlias === 'undefined' ? 'vgo' : visitorGlobalObjectAlias;
          var visitorObject = window[vgoAlias];
          if (email && typeof visitorObject !== 'undefined') {
              visitorObject('setEmail', email);
              visitorObject('update');
          } else if (typeof(trackcmp_url) != 'undefined' && trackcmp_url) {
              _load_script(trackcmp_url);
          }
          if (typeof window._form_callback !== 'undefined') window._form_callback(id);
      };
      window._show_error = function(id, message, html) {
          var form = document.getElementById('_form_' + id + '_'),
              err = document.createElement('div'),
              button = form.querySelector('button[type="submit"]'),
              old_error = form.querySelector('._form_error');
          if (old_error) old_error.parentNode.removeChild(old_error);
          err.innerHTML = message;
          err.className = '_error-inner _form_error _no_arrow';
          var wrapper = document.createElement('div');
          wrapper.className = '_form-inner _show_be_error';
          wrapper.appendChild(err);
          button.parentNode.insertBefore(wrapper, button);
          var submitButton = form.querySelector('[id^="_form"][id$="_submit"]');
          submitButton.disabled = false;
          submitButton.classList.remove('processing');
          if (html) {
              var div = document.createElement('div');
              div.className = '_error-html';
              div.innerHTML = html;
              err.appendChild(div);
          }
      };
      window._load_script = function(url, callback, isSubmit) {
          var head = document.querySelector('head'), script = document.createElement('script'), r = false;
          var submitButton = document.querySelector('#_form_120_submit');
          script.charset = 'utf-8';
          script.src = url;
          if (callback) {
              script.onload = script.onreadystatechange = function() {
                  if (!r && (!this.readyState || this.readyState == 'complete')) {
                      r = true;
                      callback();
                  }
              };
          }
          script.onerror = function() {
              if (isSubmit) {
                  if (script.src.length > 10000) {
                      _show_error("120", "Desculpe, seu envio falhou. Deixe suas respostas mais curtas e tente novamente.");
                  } else {
                      _show_error("120", "Desculpe, seu envio falhou. Tente novamente.");
                  }
                  submitButton.disabled = false;
                  submitButton.classList.remove('processing');
              }
          }
          head.appendChild(script);
      };
      (function() {
          var iti;
          if (window.location.search.search("excludeform") !== -1) return false;
          var addEvent = function(element, event, func) {
              if (element.addEventListener) element.addEventListener(event, func);
              else {
                  var oldFunc = element['on' + event];
                  element['on' + event] = function() { oldFunc && oldFunc.apply(this, arguments); func.apply(this, arguments); };
              }
          }
          var form_to_submit = document.getElementById('_form_120_');
          var allInputs = form_to_submit.querySelectorAll('input, select, textarea'), submitted = false;

          var validate_form = function(e) {
              var no_error = true;
              if (!submitted) {
                  submitted = true;
                  for (var i = 0, len = allInputs.length; i < len; i++) {
                      var input = allInputs[i];
                      if (input.getAttribute('required') !== null) {
                          if (input.type == 'text' || input.type == 'number' || input.type == 'time' || input.type == 'tel') {
                              addEvent(input, 'blur', function() { this.value = this.value.trim(); });
                              addEvent(input, 'input', function() {});
                          }
                      }
                  }
              }
              return no_error;
          };

          var _form_serialize = function(form){if(!form||form.nodeName!=="FORM"){return }var i,j,q=[];for(i=0;i<form.elements.length;i++){if(form.elements[i].name===""){continue}switch(form.elements[i].nodeName){case"INPUT":switch(form.elements[i].type){case"tel":q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].previousSibling.querySelector('div.iti__selected-dial-code').innerText)+encodeURIComponent(" ")+encodeURIComponent(form.elements[i].value));break;case"text":case"number":case"date":case"time":case"hidden":case"password":case"button":case"reset":case"submit":q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));break;case"checkbox":case"radio":if(form.elements[i].checked){q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value))}break;case"file":break}break;case"TEXTAREA":q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));break;case"SELECT":switch(form.elements[i].type){case"select-one":q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));break;case"select-multiple":for(j=0;j<form.elements[i].options.length;j++){if(form.elements[i].options[j].selected){q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].options[j].value))}}break}break;case"BUTTON":switch(form.elements[i].type){case"reset":case"submit":case"button":q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));break}break}}return q.join("&")};

          const formSupportsPost = false;

          // >>> Hook: antes de submeter, garantir que os campos calculados foram preenchidos
          function preencherCamposACComCalculo() {
            const tempoEl = document.getElementById('tempo');
            const aulasEl = document.getElementById('aulas');
            const precoEl = document.getElementById('preco');
            if (!tempoEl || !aulasEl || !precoEl) return;

            const tempo = parseFloat(String(tempoEl.value).replace(',', '.'));
            const aulas = parseFloat(String(aulasEl.value).replace(',', '.'));
            const preco = parseFloat(String(precoEl.value).replace(',', '.'));
            if ([tempo, aulas, preco].some(v => isNaN(v))) return;

            const semanal = tempo * aulas;      // horas/semana
            const mensal  = semanal * 4;        // horas/m√™s (aprox)
            const custoHora   = preco / 2;      // regra definida
            const custoMensal = custoHora * mensal;

            const f40 = document.getElementById('field40');
            const f41 = document.getElementById('field41');
            const f42 = document.getElementById('field42');
            const f43 = document.getElementById('field43');

            if (f40) f40.value = String(semanal);
            if (f41) f41.value = String(mensal);
            if (f42) f42.value = (custoHora).toLocaleString('pt-BR', { style:'currency', currency:'BRL' });
            if (f43) f43.value = (custoMensal).toLocaleString('pt-BR', { style:'currency', currency:'BRL' });
          }

          var form_submit = function(e) {
              e.preventDefault();
              if (validate_form()) {
                  // garante preenchimento antes do envio
                  try { preencherCamposACComCalculo(); } catch(err) {}

                  var submitButton = e.target.querySelector('#_form_120_submit');
                  submitButton.disabled = true;
                  submitButton.classList.add('processing');

                  var serialized = _form_serialize(document.getElementById('_form_120_')).replace(/%0A/g, '\\n');
                  async function submitForm() {
                      var formData = new FormData();
                      const searchParams = new URLSearchParams(serialized);
                      searchParams.forEach((value, key) => {
                          if (key !== 'hideButton') {
                              formData.append(key, value);
                          }
                      });
                      let request = {
                          headers: { "Accept": "application/json" },
                          body: formData,
                          method: "POST"
                      };
                      let pageUrlParams = new URLSearchParams(window.location.search);
                      if (pageUrlParams.has('t')) {
                          request.headers.Authorization = 'Bearer ' + pageUrlParams.get('t');
                      }
                      const response = await fetch('https://arnese.activehosted.com/proc.php?jsonp=true', request);
                      return response.json();
                  }
                  if (formSupportsPost) {
                      submitForm().then((data) => { eval(data.js); })
                        .catch(() => { _show_error("120", "Desculpe, seu envio falhou. Tente novamente."); });
                  } else {
                      _load_script('https://arnese.activehosted.com/proc.php?' + serialized + '&jsonp=true', null, true);
                  }
              }
              return false;
          };
          addEvent(form_to_submit, 'submit', form_submit);

          // Exposi√ß√£o global para chamarmos tamb√©m do fluxo da calculadora
          window.__preencherCamposACComCalculo = preencherCamposACComCalculo;
      })();
      </script>
      <!-- ===== /Formul√°rio ActiveCampaign ===== -->
    </div>
  </div>

  <style>
    .print-button {
      background-color: #2196F3;
      color: white;
      margin-top: 1em;
      display: none;
    }
    .print-button:hover { background-color: #1976D2; }
  </style>

  <button class="print-button" id="print-btn" onclick="window.print()">üñ®Ô∏è Imprimir Resultados</button>

  <!-- script de calculo -->
  <script>
    let dadosCalculados = "";
    let formularioEnviado = false;

    function formatarMoeda(valor) {
      return valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
    }

    function calcular() {
      const tempo = parseFloat(document.getElementById('tempo').value);
      const aulas = parseFloat(document.getElementById('aulas').value);
      const preco = parseFloat(document.getElementById('preco').value);

      const semanal = tempo * aulas;
      const mensal = semanal * 4;
      const dias = Math.floor(mensal / 24);
      const horasRestantes = mensal % 24;
      const diasTexto = dias > 0 ? `${dias} dia${dias > 1 ? 's' : ''}` : "";
      const horasTexto = horasRestantes > 0 ? `${horasRestantes} hora${horasRestantes > 1 ? 's' : ''}` : "";
      const complemento = diasTexto && horasTexto ? `${diasTexto} e ${horasTexto}` : diasTexto || horasTexto;
      const mostraComplemento = mensal >= 24 ? ` / <strong>${complemento}</strong>` : "";

      const custoHora = preco / 2;
      const custoMensal = custoHora * mensal;

      dadosCalculados = `
        <h2>üìä Resultados</h2>
        <p>üóìÔ∏è Horas de planejamento por semana: <strong>${semanal}h</strong></p>
        <p>üìÜ Horas de planejamento por m√™s: <strong>${mensal}h</strong>${mostraComplemento}</p>
        <p>üí∏ Custo do planejamento por hora: <strong>${formatarMoeda(custoHora)}</strong></p>
        <p>üíº Custo total do planejamento mensal: <strong>${formatarMoeda(custoMensal)}</strong></p>
      `;

      // >>> Preenche os campos do AC ANTES de abrir o modal (garantia prim√°ria)
      if (typeof window.__preencherCamposACComCalculo === 'function') {
        try { window.__preencherCamposACComCalculo(); } catch(e) {}
      }

      if (!formularioEnviado) {
        document.getElementById('modal').style.display = 'flex';
      } else {
        const resultados = document.getElementById('resultados');
        resultados.innerHTML = dadosCalculados;
        resultados.style.display = 'block';
        const printBtn = document.getElementById('print-btn');
        if (printBtn) printBtn.style.display = 'inline-block';
      }
    }

    document.addEventListener("DOMContentLoaded", function () {
      const printBtn = document.getElementById('print-btn');
      if (printBtn) printBtn.style.display = 'none';
    });

    // Callback padr√£o do ActiveCampaign ap√≥s envio do formul√°rio
    window._form_callback = function(id) {
      formularioEnviado = true;
      document.getElementById('modal').style.display = 'none';
      const resultados = document.getElementById('resultados');
      resultados.innerHTML = dadosCalculados;
      resultados.style.display = 'block';
      const printBtn = document.getElementById('print-btn');
      if (printBtn) printBtn.style.display = 'inline-block';
    };
  </script>

</body>
</html>