<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calculadora de Planejamento de Aulas</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Archivo:100..900&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <style>
    body { background:#fff; max-width:600px; margin:0 auto; padding:2em; }
    h1 { font-family:Archivo, sans-serif; text-align:center; color:#333; }
    label { display:block; margin-top:1em; font-weight:700; font-family:Archivo, sans-serif; }
    input { width:100%; padding:0.5em; margin-top:0.25em; box-sizing:border-box; font-family:Archivo, sans-serif; }
    button { margin-top:2em; padding:1em; width:100%; font-size:16px; border:none; cursor:pointer; font-family:Archivo, sans-serif; }
    button:hover{ opacity:.9; }
    .calculate-button{ background:#4CAF50; color:#fff; }
    .print-button{ background:#2196F3; color:#fff; margin-top:1em; display:none; }
    .results{ margin-top:2em; padding:1em; background:#eef; border-left:5px solid #4CAF50; display:none; font-family:Archivo, sans-serif; }
    .modal{ display:none; position:fixed; inset:0; background:rgba(0,0,0,.6); justify-content:center; align-items:center; z-index:9999; font-family:Archivo, sans-serif; }
    .modal-content{ background:#fff; padding:2em; border-radius:8px; max-width:450px; width:90%; }
  </style>
</head>
<body>
  <h1>üìò Planejamento de Aulas</h1>

  <label>‚è±Ô∏è Tempo para planejar uma aula (h):
    <input type="number" id="tempo" value="1" step="0.5">
  </label>
  <label>üìÖ Aulas por semana:
    <input type="number" id="aulas" value="10">
  </label>
  <label>üí∞ Pre√ßo por hora/aula (R$):
    <input type="number" id="preco" value="100">
  </label>

  <button class="calculate-button" onclick="calcular()">Calcular</button>

  <div class="results" id="resultados"></div>
  <button class="print-button" id="print-btn" onclick="window.print()">üñ®Ô∏è Imprimir Resultados</button>

  <!-- Modal com formul√°rio -->
  <div class="modal" id="modal">
    <div class="modal-content">
      <h3>üîí Informe seus dados para visualizar o resultado</h3>

      <!-- ===== Formul√°rio ActiveCampaign ===== -->
      <style>@import url(https://fonts.bunny.net/css?family=inter-tight:400,700);</style>
      <style>
        #_form_120_{font-size:14px;line-height:1.6;font-family:arial,helvetica,sans-serif;margin:0}
        #_form_120_ input[type="text"],#_form_120_ input[type="tel"],#_form_120_ input[type="date"],#_form_120_ textarea{padding:6px;border:#979797 1px solid;border-radius:4px;color:#000;font-size:14px;box-sizing:border-box}
        #_form_120_ ._submit{cursor:pointer;font-size:14px;text-align:center;background:#1F1F1F;border:0;color:#fff;padding:10px}
        #_form_120_{position:relative;text-align:left;margin-top:10px;max-width:400px}
      </style>

      <form method="POST" action="https://arnese.activehosted.com/proc.php" id="_form_120_" class="_form _form_120 _inline-form _dark" novalidate data-styles-version="5">
        <input type="hidden" name="u" value="120" />
        <input type="hidden" name="f" value="120" />
        <input type="hidden" name="s" />
        <input type="hidden" name="c" value="0" />
        <input type="hidden" name="m" value="0" />
        <input type="hidden" name="act" value="sub" />
        <input type="hidden" name="v" value="2" />
        <input type="hidden" name="or" value="c7718130acc52be2e48c206c02dc0a90" />

        <div class="_form-content">
          <div class="_form_element _x88496739 _full_width">
            <label for="fullname" class="_form-label">nome<span class="field-required">*</span></label>
            <div class="_field-wrapper">
              <input type="text" id="fullname" name="fullname" placeholder="Digite seu nome" required/>
            </div>
          </div>

          <div class="_form_element _x57568190 _full_width">
            <label for="email" class="_form-label">email<span class="field-required">*</span></label>
            <div class="_field-wrapper">
              <input type="text" id="email" name="email" placeholder="Digite seu email" required/>
            </div>
          </div>

          <!-- Campos adicionais (podem ser hidden se preferir) -->
          <div class="_form_element _x57866303 _full_width">
            <label for="field[40]" class="_form-label">Horas por semana</label>
            <div class="_field-wrapper">
              <input type="text" id="field[40]" name="field[40]" value="" placeholder="horas_semana" />
            </div>
          </div>
          <div class="_form_element _x65657050 _full_width">
            <label for="field[41]" class="_form-label">Horas por m√™s</label>
            <div class="_field-wrapper">
              <input type="text" id="field[41]" name="field[41]" value="" placeholder="horas_mes" />
            </div>
          </div>
          <div class="_form_element _x01312186 _full_width">
            <label for="field[42]" class="_form-label">Custo por hora</label>
            <div class="_field-wrapper">
              <input type="text" id="field[42]" name="field[42]" value="" placeholder="custo_hora" />
            </div>
          </div>
          <div class="_form_element _x27378920 _full_width">
            <label for="field[43]" class="_form-label">Custo mensal</label>
            <div class="_field-wrapper">
              <input type="text" id="field[43]" name="field[43]" value="" placeholder="custo_mes" />
            </div>
          </div>

          <div class="_button-wrapper _full_width">
            <button id="_form_120_submit" class="_submit" type="submit">Enviar</button>
          </div>
          <div class="_clear-element"></div>
        </div>
        <div class="_form-thank-you" style="display:none;"></div>
      </form>

      <script>
        // ===== Utils da p√°gina =====
        let dadosCalculados = "";
        let formularioEnviado = false;

        function formatarMoeda(valor) {
          return valor.toLocaleString('pt-BR', { style:'currency', currency:'BRL' });
        }

        function mostrarResultadosNaPagina(){
          const resultados = document.getElementById('resultados');
          resultados.innerHTML = dadosCalculados;
          resultados.style.display = 'block';
          const printBtn = document.getElementById('print-btn');
          if (printBtn) printBtn.style.display = 'inline-block';
        }

        // ===== Helpers para AC =====
        function getACField(idComOuSemColchete) {
          return document.getElementById(idComOuSemColchete) || document.querySelector(`[name="${idComOuSemColchete}"]`);
        }

        function preencherCamposACComCalculo(){
          const tempo = parseFloat(String(document.getElementById('tempo').value).replace(',','.'));
          const aulas = parseFloat(String(document.getElementById('aulas').value).replace(',','.'));
          const preco = parseFloat(String(document.getElementById('preco').value).replace(',','.'));
          if ([tempo,aulas,preco].some(v => isNaN(v))) return;

          const semanal = tempo * aulas;          // horas/semana
          const mensal  = semanal * 4;            // horas/m√™s (aprox)
          const custoHora   = preco / 2;          // regra definida
          const custoMensal = custoHora * mensal; // total mensal

          const f40 = getACField('field[40]'); // Horas semana
          const f41 = getACField('field[41]'); // Horas m√™s
          const f42 = getACField('field[42]'); // Custo/hora
          const f43 = getACField('field[43]'); // Custo/m√™s

          if (f40) f40.value = String(semanal);
          if (f41) f41.value = String(mensal);
          if (f42) f42.value = (custoHora).toLocaleString('pt-BR',{style:'currency',currency:'BRL'});
          if (f43) f43.value = (custoMensal).toLocaleString('pt-BR',{style:'currency','currency':'BRL'});
        }

        // ===== Callbacks AC: manter tudo na mesma p√°gina =====
        window._form_callback = function(id){
          formularioEnviado = true;
          document.getElementById('modal').style.display = 'none';
          mostrarResultadosNaPagina();
        };

        window._show_thank_you = function(id, message, trackcmp_url, email) {
          const form = document.getElementById('_form_' + id + '_');
          if (form) {
            const content = form.querySelector('._form-content');
            const ty = form.querySelector('._form-thank-you');
            if (content && ty){ content.style.display = 'none'; ty.innerHTML = message || ''; ty.style.display = 'block'; }
          }
          if (typeof window._form_callback === 'function') window._form_callback(id);
        };
        window._show_unsubscribe = function(){};
        window._show_error = function(id, message){ alert(message || 'Falha ao enviar.'); };

        // ===== Envio controlado (SEM redirecionar) =====
        (function(){
          const form = document.getElementById('_form_120_');
          if (!form) return;

          const formSupportsPost = true; // for√ßa fetch/POST (sem JSONP redirect)

          // Serializa√ß√£o compat√≠vel com o embed
          function _form_serialize(form){
            if(!form||form.nodeName!=="FORM"){return}
            var i,j,q=[];
            for(i=0;i<form.elements.length;i++){
              if(form.elements[i].name===""){continue}
              switch(form.elements[i].nodeName){
                case"INPUT":
                  switch(form.elements[i].type){
                    case"text":case"number":case"date":case"time":case"hidden":case"password":case"button":case"reset":case"submit":
                      q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));break;
                    case"checkbox":case"radio":
                      if(form.elements[i].checked){q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value))}break;
                  }break;
                case"TEXTAREA":
                  q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));break;
                case"SELECT":
                  switch(form.elements[i].type){
                    case"select-one":
                      q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));break;
                    case"select-multiple":
                      for(j=0;j<form.elements[i].options.length;j++){
                        if(form.elements[i].options[j].selected){
                          q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].options[j].value))
                        }
                      }break;
                  }break;
                case"BUTTON":
                  switch(form.elements[i].type){
                    case"reset":case"submit":case"button":
                      q.push(form.elements[i].name+"="+encodeURIComponent(form.elements[i].value));break;
                  }break;
              }
            }
            return q.join("&");
          }

          form.addEventListener('submit', function(e){
            e.preventDefault();

            // Garante que os campos com colchete foram preenchidos
            try { preencherCamposACComCalculo(); } catch(_) {}

            const submitBtn = form.querySelector('#_form_120_submit');
            if (submitBtn){ submitBtn.disabled = true; submitBtn.classList.add('processing'); }

            const serialized = _form_serialize(form).replace(/%0A/g, '\\n');

            async function submitForm(){
              const formData = new FormData();
              const params = new URLSearchParams(serialized);
              params.forEach((value,key)=>{ if (key !== 'hideButton') formData.append(key,value); });
              const request = { headers:{ "Accept":"application/json" }, body:formData, method:"POST" };
              const resp = await fetch('https://arnese.activehosted.com/proc.php?jsonp=true', request);
              return resp.json();
            }

            if (formSupportsPost) {
              submitForm()
                .then((data)=>{ try { eval(data.js); } catch(e){ alert('Erro ao processar resposta.'); } })
                .catch(()=>{ alert('Desculpe, seu envio falhou. Tente novamente.'); })
                .finally(()=>{ if (submitBtn){ submitBtn.disabled=false; submitBtn.classList.remove('processing'); }});
            } else {
              // N√ÉO USAR: modo JSONP tende a redirecionar para thankyou.php
              // const head = document.querySelector('head');
              // const s = document.createElement('script');
              // s.src = 'https://arnese.activehosted.com/proc.php?' + serialized + '&jsonp=true';
              // head.appendChild(s);
            }
          });

          // exp√µe para a fun√ß√£o calcular()
          window.__preencherCamposACComCalculo = preencherCamposACComCalculo;
        })();
      </script>
      <!-- ===== /Formul√°rio ActiveCampaign ===== -->
    </div>
  </div>

  <script>
    // C√°lculo e exibi√ß√£o
    function formatarMoeda(valor) {
      return valor.toLocaleString('pt-BR', { style:'currency', currency:'BRL' });
    }

    function calcular() {
      const tempo = parseFloat(document.getElementById('tempo').value);
      const aulas = parseFloat(document.getElementById('aulas').value);
      const preco = parseFloat(document.getElementById('preco').value);

      const semanal = tempo * aulas;
      const mensal = semanal * 4;
      const dias = Math.floor(mensal / 24);
      const horasRestantes = mensal % 24;
      const diasTexto = dias > 0 ? `${dias} dia${dias > 1 ? 's' : ''}` : "";
      const horasTexto = horasRestantes > 0 ? `${horasRestantes} hora${horasRestantes > 1 ? 's' : ''}` : "";
      const complemento = diasTexto && horasTexto ? `${diasTexto} e ${horasTexto}` : diasTexto || horasTexto;
      const mostraComplemento = mensal >= 24 ? ` / <strong>${complemento}</strong>` : "";

      const custoHora = preco / 2;
      const custoMensal = custoHora * mensal;

      dadosCalculados = `
        <h2>üìä Resultados</h2>
        <p>üóìÔ∏è Horas de planejamento por semana: <strong>${semanal}h</strong></p>
        <p>üìÜ Horas de planejamento por m√™s: <strong>${mensal}h</strong>${mostraComplemento}</p>
        <p>üí∏ Custo do planejamento por hora: <strong>${formatarMoeda(custoHora)}</strong></p>
        <p>üíº Custo total do planejamento mensal: <strong>${formatarMoeda(custoMensal)}</strong></p>
      `;

      // Preenche campos do AC ANTES de abrir o modal
      if (typeof window.__preencherCamposACComCalculo === 'function') {
        try { window.__preencherCamposACComCalculo(); } catch(e){}
      }

      if (!formularioEnviado) {
        document.getElementById('modal').style.display = 'flex';
      } else {
        mostrarResultadosNaPagina();
      }
    }

    document.addEventListener("DOMContentLoaded", function () {
      const printBtn = document.getElementById('print-btn');
      if (printBtn) printBtn.style.display = 'none';
    });
  </script>
</body>
</html>